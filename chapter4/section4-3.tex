%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Author: Sibi <sibi@psibi.in>
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass{article}
\usepackage{graphicx}
\usepackage{verbatim}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{tabularx}
\setlength\parskip{\baselineskip}
\begin{document}
\title{Chapter 4 (Section 4.3)}
\author{Sibi}
\date{\today}
\maketitle
\newpage

\section{Problem 1}

$R = \{(a,bad), (a,cab), (b,bad), (b,bed), (b,cab), (c,cab), (d,bad),
(d, bed), (e,bed), (e,bed)\}$

\section{Problem 2}

$A = \{cat, dog, bird, rat\}$
$R = \{(x,y) \in A \times A \mid there is at least one letter that
occurs in both of the words x and y\}$

$R = \{(cat, cat), (cat, rat), (dog, dog), (dog, birds), (bird, dog),
(bird, bird), (bird, rat), (rat, cat), (rat, bird), (rat, rat)\}$

\begin{itemize}
\item Reflexive
\item Symmetric
\item Not transitive: there is an edge from bird to rat and rat to
  cat. But there is no edge from bird to cat.
\end{itemize}

\section{Problem 3}

$i_{A} = \{(x,y) \in A \times A \mid x = y\}$
$i_{A} = \{(1,1), (2,2), (3,3), (4,4)\}$

\section{Problem 4}

\subsection(Solution (a))

$R = \{(a,c), (c,c), (d,a), (d,b), (b,d)\}$

\begin{itemize}
\item Not reflexive since $(a,a) \notin R$
\item Not symmetric since $(a,c) \implies (c,a)$ doesn't hold
\item Not transitive since $(d,a) \land (d,c) \implies (d,c)$ doesn't hold
\end{itemize}

\subsection{Solution (b)}

$R = \{(a,b), (b,a), (a,d), (b,d)\}$

\begin{itemize}
\item Not reflexive since $(a,a) \notin R$
\item Not symmetric since $(a,d) \implies (d,a)$ doesn't hold
\item Not transitive since $(a,b) \land (b,a) \implies (a,a)$ doesn't hold
\end{itemize}

\subsection{Solution (c)}

$R = \{(a,a), (c,c), (b,b), (b,d), (d,b), (d,d)\}$

\begin{itemize}
\item Reflexive
\item Symmetric
\item Transitive
\end{itemize}

\subsection{Solution (d)}

$R = \{(a,c), (a,b), (a,d), (b,d), (c,d)\}$

\begin{itemize}
\item Not reflexive
\item Not symmetric
\item Transitive
\end{itemize}

\section{Solution 5}

$S \circ R = \{(a,c) \in A \times C \mid \exists b \in B((a,b) \in R
\land (b,c) \in S\}$

$S \circ R = \{(b,x), (a,y), (c,y), (a,z), (c,z)\}$

\section{Solution 6}

$ D_r = \{(x,y) \in R \times R \mid |x - y| < r \}$
$ D_s = \{(x,y) \in R \times R \mid |x - y| < s \}$

$ D_r \circ D_s = \{(a,b) \in R \times R \mid \exists c \in R((a,c)
\in D_s \land (c,b) \in D_r)\}$
$= \{(a,b) \in R \times R \mid \exists c \in R (|a - c| < s \land |c -
b| < r)\}$

From triangle inequality, $|a + b| < |a| + |b|$
$|(a-c) + (c-b)| < |a-c| + |c-b|$
$|a + (-b)| < s + r$
$ D_r \circ D_s = \{(a,b) \in R \times R \mid |a-b| < s + r\}$

\section{Problem 7}

($\Rightarrow$) Suppose $R$ is reflexive. Then from the definition of
reflexive it follows that $\forall. x \in A((x,x) \in R)$. Then
clearly, $i_A \subseteq R$.

($\Leftarrow$) Suppose $i_A \subseteq R$. Let $x$ be an arbitrary
element in $A$. Then $(x,x) \in i_A$. From $i_A \subseteq R$, it
follows that $(x,x) \in R$. Since $x$ was arbitrary we can conclude
that $R$ is reflexive.

\section{Problem 8}

($\Rightarrow$) Suppose $R$ is transitive. Let $(x,z)$ be an arbitrary
element in $R \circ R$. Then by existential instantiation, $(x,c) \in
R$ and $(c,z) \in R$. Since $R$ is transitive, it follows that $(x,z)
\in R$. So $R \circ R \subseteq R$.

($\Leftarrow$) Suppose $R \circ R \subseteq R$. Let $x$, $y$, $z$ be
an arbitrary element in $A$ such that $(x,y) \in R$ and $(y,z) \in R$.
So, $(x,z) \in R \circ R$. It follows that $(x,z) \in R$. Since $x,z$
are arbitrary, $R$ is transitive.

\section{Problem 9}

\subsection{Solution (a)}

($\Rightarrow$) Suppose $R \circ i_A$. Let $(a,b)$ be an arbitrary
element in $R \circ i_A$. By existential instantiation, it follows
that $(a,c) \in i_A$ and $(c,b) \in R$. From $(a,c) \in i_A$, it
follows that $a = c$. So, $(a,b) \in R$. Since $(a,b)$ is arbitrary it
follows that $R \circ i_A \subseteq R$.

($\Leftarrow$) Suppose $R$. Let $(a,b)$ be an arbitrary element in
$R$. Now $a \in A$. So, $(a,a) \in i_A$. Therefore $(a,b) \in R \circ
i_A$. Since $(a,b)$ is arbitrary, we can conclude that $R \subseteq R
\circ i_A$.

\subsection{Solution (b)}

($\Rightarrow$) Suppose $i_B \circ R$. Let $(a,b)$ be an arbitrary element in $i_B
\circ R$. By existential instantiation, $(a,c) \in R$ and $(c,b) \in
i_B$. From the definition of identity relation it follows that $c =
b$. So, $(a,b) \in R$. Therefore, $i_B \circ R \subseteq R$.

($\Leftarrow$) Let $(a,b)$ be an arbitrary element in $R$. Now $b \in
B$. So, $(b,b) \in i_B$. So, $(a,b) \in i_B \circ R$. Since $(a,b)$ is
arbitrary it follows that $R \subseteq i_B \circ R$.

\section{Problem 10}

Let $(a,a)$ be an arbitrary element in $i_D$. It follows that $a \in
D$. By existential instantiation, $(a,b) \in S$. Also, $(b,a) \in
S^{-1}$. So, $(a,a) \in S^{-1} \circ S$. Since $(a,a)$ was an
arbitrary element it follows that $i_D \subseteq S^{-1} \circ S$.

Let $(a,a)$ be an arbitrary element in $i_R$. It follows that $a \in
R$. By existential instantiation, it follows that $(b,a) \in S$. Also,
$(a,b) \in S^{-1}$. So $(a,a) \in S \circ S^{-1}$. Since $(a,a)$  was
an arbitrary element it $i_R \subseteq S \circ S^{-1}$.

\section{Problem 11}

Suppose $R$ is reflexive. Let $(a,b)$ be an arbitrary element in $R$.
It follows that both $a \in A$ and $b \in A$. Now since $R$ is
reflexive it follows that $(b,b) \in R$. Therefore $(a,b) \in R \circ
R$. Since $(a,b)$ is arbitrary it follows that $R \subseteq R \circ R$.

\section{Problem 12}

\subsection{Solution (a)}
Suppose $R$ is reflexive. Let $a$ be an arbitrary element in $A$. Then
it follows that $(a,a) \in R$ . Then clearly $(a,a) \in R^{-1}$. Since
$a$ was arbitrary it follows that $\forall a \in A((a,a) \in R^{-1})$.
Therefore, $R^{-1}$ is reflexive.

\subsection{Solution (b)}
Suppose $R$ is symmetric. Let $a$ and $b$ be an arbitrary element in
$A$ such that $(a,b) \in R^{-1}$. From $(a,b) \in R^{-1}$ it follows
that $(b,a) \in R$. Since $R$ is symmetric, it follows that $(a,b) \in
R$. So, $(b,a) \in R^{-1}$. Therefore, if $(a,b) \in R^{-1}$ then
$(b,a) \in R^{-1}$. Since $a$ and $b$ are arbitrary, it follows that
$R^{-1}$ is symmetric.

\subsection{Solution (c)}
Suppose $R$ is transitive. Let $a$, $b$ and $c$ be an arbitrary
element in $A$ such that $(a,b) \in R^{-1}$ and $(b,c) \in R^{-a}$. It
follows that $(b,a) \in R$ and $(c,b) \in R$. Since $R$ is transitive
we get $(c,a) \in R$. So, clearly $(a,c) \in R^{-1}$. Therefore
$R^{-1}$ is transitive.

\section{Problem 13}

\subsection{Solution (a)}

Let $a$ be an arbitrary element in $A$. Suppose $R_1$ and $R_2$ are
reflexive. Then it follows that $(a,a) \in R_1$ and $(a,a) \in R_2$.
Therefore $R_1 \cup R_2$ is reflexive.

\subsection{Solution (b)}

Let $a, b$ be an arbitrary element in $A$. Suppose $a (R_1 \cup R_2)b$
or $(a,b) \in R_1 \cup R_2$. Let us consider the cases separately:

Case 1. $(a,b) \in R_1$. Since $R_1$ is symmetric it follows that
$(b,a) \in R_1$. Therefore $(b,a) \in R_1 \cup R_2$. 
Case 2. $(a,b) \in R_2$. Since $R_2$ is symmetric it follows that
$(b,a) \in R_2$. Therefore $(b,a) \in R_1 \cup R_2$.

Since a and b are arbitrary, it follows that $R_1 \cup R_2$ is symmetric.

\subsection{Solution (c)}

$R_1 = \{(1,2), (2,1), (1,1)$
$R_2 = \{(4,2), (2,9), (4,9)\}$

It's not transitive since $(4,2) \in R_1 \cup R_2 \land (2,1) \in R_1
\cup R_2 \implies (4,1) \in R_1 \cup R_2$ doesn't hold.

\section{Problem 14}

\subsection{Solution (a)}

Suppose $R_1$ and $R_2$ are reflexive. Let $a$ be an arbitrary element
in $A$. Since $R_1$ and $R_2$ are reflexive, it follows that $(a,a)
\in R_1 \cap R_2$. Since $a$ is arbitrary, we can conclude that $R_1
\cap R_2$ is reflexive.

\subsection{Solution (b)}

Suppose $R_1$ and $R_2$ are symmetric. Let $x$ and $y$ be arbitrary
elements in $A$ such that $(x,y) \in R_1 \cap R_2$. Since both $R_1$
and $R_2$ are symmetric, it follows that $(y,x) \in R_1 \cap R_2$.
Since $x$ and $y$ are arbitrary, we can conclude that $R_1 \cap R_2$
is symmetric.

\subsection{Solution (c)}

Suppose $R_1$ and $R_2$ are transitive. Let $x, y$ and $z$ e an
arbitrary element in $A$ such that $(x,y) \in R_1 \cap R_2$ and $(y,z)
\in R_1 \cap R_2$. Since $R_1$ and $R_2$ are transitive, it follows
that $(x,z) \in R_1 \cap R_2$. Therefore $R_1 \cap R_2$ is transitive.

\section{Problem 15}

\subsection{Solution (a)}

Counterexample:

$A = \{1\}$ \\
$R_1 = \{(1,1)\}$ \\
$R_2 = \{(1,1)\}$ \\
$R_1 \setminus R_2 = \emptyset$

\subsection{Solution (b)}

Suppose $R_1$ and $R_2$ are symmetric. Let $x$ and $y$ be arbitrary
element in $A$ such that $(x,y) \in R_1 \setminus R_2$. So,
$(x,y) \in R_1$. Since $R_1$ is symmetric, it follows that
$(y,x) \in R_1$. Also $(x,y) \notin R_2$. Using contrapositive law and
symmetric property, then $(y,x) \notin R_2$. Therefore $(y,x) \in
R_1 \setminus R_2$.

\subsection{Solution (c)}

Counterexample: \\
$R_1 = \{(1,2),(2,4),(1,4)\}$ \\
$R_2 = \{(1,3),(3,4),(1,4)\}$ \\
$R_1 \setminus R_2 = \{(1,2), (3,4)\}$

\section{Problem 16}

Suppose $R$ and $S$ are reflexive. Let $a$ be an arbitrary element in
$A$. Since $R$ and $S$ are reflexive, it follows that $(a,a) \in R$
and $(a,a) \in S$. It follows that, $(a,a) \in R \circ S$. Since $a$
is arbitrary, we can conclude that $R \circ S$ is reflexive.

\section{Problem 17}

Suppose R and S are symmetric.

($\Rightarrow$) Suppose $R \circ S$ is symmetric. Let $(x,y)$ be an
arbitrary element in $R \circ S$. Then by existential instantiation,
it follows that $(x,a) \in S$ and $(a,y) \in R$. Now since $R$ and $S$
are symmetric it follows that $(a,x) \in S$ and $(y,a) \in R$. So,
$(y,x) \in S \circ R$. Since $R \circ S$ is symmetric,
$(y,x) \in R \circ S$. Since $x$ and $y$ are symmetric, it follows
that $R \circ S \subseteq S \circ R$. Similarly we can prove that $S
\circ R \subseteq R \circ S$. So, $S \circ R = R \circ S$.

($\Leftarrow$) Suppose $S \circ R = R \circ S$. Let $a,b$ be an
arbitrary element in $A$ such that $(a,b) \in R \circ S$. From our
assumption, it follows that $(a,b) \in S \circ R$. By existential
instantiation, $(a,c) \in R$ and $(c,b) \in S$. Since $R$ and $S$ are
symmetric, it follows that $(c,a) \in R$ and $(b,a) \in S$. So
$(b,a) \in R \circ S$. Now since $a$ and $b$ are arbitrary it follows
that $R \circ S$ is symmetric.

\section{Problem 18}

Suppose $S \circ R \subseteq R \circ S$. Let $a,b$ and $c$ be
arbitrary elements of $A$ such that $(a,b) \in R \circ S$ and
$(b,c) \in R \circ S$. By existential instantiation, it follows that
$(a,d) \in S$ and $(d,b) \in R$. Similarly, $(b,e) \in S$ and
$(e,c) \in R$. It follows that $(d,e) \in S \circ R$. From our
assumption, it follows that $(d,e) \in R \circ S$. By existential
instantiation, $(d,f) \in S$ and $(f,e) \in R$. From $(e,c) \in R$ and
$(f,e) \in R$, it follows that $(f,c) \in R \circ R$. Similarly from
$(d,f) \in S$ and $(a,d) \in S$, it follows that
$(a,f) \in S \circ S$. Using Theorem 4.3.4(3), $(f,c) \in R$ and
$(a,f) \in S$. So $(a,c) \in R \circ S$. Since $a$ and $c$ are
arbitrary, $R \circ S$ is transitive.

\section{Problem 19}

\subsection{Solution (a)}

Existential instantiation uses same variable.

\subsection{Solution (b)}

Counterexample: \\
$R = \{(1,3), (2,9)\}$ \\
$S = \{(\{1\},\{2,3\}), (\{(2,3\}, \{9\})\}$ 

\section{Problem 20}

Suppose $R$ is transitive. Let $X,Y$ and $Z$ be arbitrary elements in
$B$ such that $(X,Y) \in S$ and $(Y,Z) \in S$. From $(X,Y) \in S$, it
follows that $\forall x \in X \forall y \in Y xRy$. Similarly,
$\forall y \in Y \forall z \in Z yRz$. Now since $R$ is transitive,
$\forall x \in X \forall z \in Z xRz$. Therefore $(X,Z) \in S$. Since
$X,Y$ and $Z$ are arbitrary, $S$ is transitive.

\section{Problem 21}

\subsection{Solution (a)}

Suppose $R$ is symmetric. Let $X$ be an arbitrary element in $P(A)$.
We have to prove that $(X,X) \in S$. Let $x$ be an arbitrary element
in $X$. From $x \in X$ and $X \in P(A)$, it follows that $x \in A$.
Since $R$ is symmetric $(x,x) \in R$. Since $x$ is arbitrary, it
follows that $\forall x \in X (x,x) \in R$. Applying universal
instantiation and existential generalization gives us $\forall x \in X
\exists y \in X(x,y) \in R$

Q.E.D

\subsection{Solution(b)}

Counter example:

$R = \{(1,2), (2,1), (3,1), (1,3)\}$ \\
$X = \{1\}, Y = \{2,3\}$ \\
$(Y,X) \notin S$

\subsection{Solution (c)}

Suppose $R$ is transitive. Let $X,Y$ and $Z$ be arbitrary element in
$P(A)$ such that $(X,Y) \in R$ and $(Y,Z) \in R$. Let $x$ be an
arbitrary element in $X$ and $z$ be some element in $Z$. We have to
prove that $xRz$. From $(X,Y) \in R$ and $x \in X$, it follows that
$\exists y \in Y (xRy)$. From $\exists y \in Y (xRy)$ and
$(Y,Z) \in R$ and applying the transitive property, we get $xRz$.

\section{Problem 22}

Flaw is in the assumption of $xRy$. No where it is given to be
assumed. \\

Theorem is false.

%Phew! this took some time. Finally worked out this solution.
%with help from lots of nice people.% 
\section{Problem 23}
Suppose $F \subseteq P(A)$. Let $a,b,c$ be arbitrary elements of A
such that $(a,b) \in R$ and $(b,c) \in R$. We have to prove that
$(a,c) \in R$. Expanding $(a,c) \in R$, we get $\forall X(X \subseteq
A \setminus \{a,c\}) \implies X \cup \{a\} \in F \implies X \cup \{C\}
\in F)$. Let $X$ be arbitrary and suppose $X \subseteq A \setminus
\{a,c\}$ and $X \cup \{a\} \in F$. We have to prove that $X \cup \{c\}
\in F$. We can consider two cases:

Case 1. $b \notin X$. From $X \subseteq A \setminus \{a,c\}$, it
follows that $a \notin X$ and $c \notin X$. From $(a,b) \in R$ and
$(b,c) \in R$, it follows that $X \cup \{c\} \in F$.

Case 2. $b \in X$. Let $X_o = X \setminus \{b\}, X' = X_o \cup \{a\},
X'' = X_o \cup \{c\}$. We know that $c \notin X$, so $c \notin X'$. So
$b,c \notin X'$. Also, $X' \cup \{b\} = X_o \cup \{a\} \cup \{b\} = X
\setminus \{b\} \cup \{a\} \cup \{b\}$. Now $X \setminus \{b\} \cup
\{a\} \cup \{b\} = X \cup \{a\} $ since $b \in X$. From $X \cup \{a\}
\in F$, it follows that $X' \cup \{b\} \in F$. It follows that $X'
\cup \{c\} \in F$ from $(b,c) \in R$. $X' \cup \{c\} = X_o \cup \{a\}
\cup \{c\} = X'' \cup \{a\}$, so $X'' \cup \{a\} \in F$. We know that
$a,b \notin X$, so $a,b \notin X_o$. So $a,b \notin X''$. We also know
that $X'' \cup \{a\} \in F$. So from $(a,b) \in R$, it follows that
$X'' \cup \{b\} \in F$. $X'' \cup \{b\} = X_o \cup \{b\} \cup \{c\} =
X \setminus \{b\} \cup \{b\} \cup \{c\}$. $X \setminus \{b\} \cup
\{b\} \cup \{c\} = X \cup \{c\}$ since $b \in X$. Therefore $X \cup
\{c\} \in X$.

\end{document}



